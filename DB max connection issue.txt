SELECT count(*) AS idle_connection_count
FROM pg_stat_activity
WHERE state = 'idle';


SELECT pid, usename, datname, client_addr, application_name, state, backend_start, state_change, query
FROM pg_stat_activity
WHERE state = 'idle';


SELECT pg_terminate_backend(pid)
  FROM pg_stat_activity
  WHERE state = 'idle'
    AND usename IN ('postgres', 'cloudpixel_website_db_user', 'edge_course_user', 'quicktestbd_backend_db_user','somikkhon_db_user')
    AND now() - state_change > interval '1 minutes';



SELECT pg_terminate_backend(pid) 
FROM pg_stat_activity
WHERE state = 'idle'
  AND usename IN (
    'postgres',
    'cloudpixel_website_db_user',
    'edge_course_user',
    'quicktestbd_backend_db_user',
    'somikkhon_db_user'
  )
  AND pid <> pg_backend_pid();